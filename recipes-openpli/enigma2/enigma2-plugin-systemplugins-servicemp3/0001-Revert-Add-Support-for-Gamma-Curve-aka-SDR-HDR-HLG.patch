From cbf6512963697d9449d1cadc4a891009116d4176 Mon Sep 17 00:00:00 2001
From: Hains van den Bosch <hainsvdbosch@ziggo.nl>
Date: Mon, 31 Dec 2018 11:12:20 +0100
Subject: [PATCH] Revert "Add Support for Gamma Curve (aka SDR/HDR/HLG)"

This reverts commit 9d02fc2277469d158cc2dbf89a102f6a4f56bf84.
---
 servicemp3/servicemp3.cpp | 9 +--------
 servicemp3/servicemp3.h   | 2 +-
 2 files changed, 2 insertions(+), 9 deletions(-)

diff --git a/servicemp3/servicemp3.cpp b/servicemp3/servicemp3.cpp
index 93e570e..562b3cc 100644
--- a/servicemp3/servicemp3.cpp
+++ b/servicemp3/servicemp3.cpp
@@ -449,7 +449,7 @@ eServiceMP3::eServiceMP3(eServiceReference ref):
 	CONNECT(m_subtitle_sync_timer->timeout, eServiceMP3::pushSubtitles);
 	CONNECT(m_pump.recv_msg, eServiceMP3::gstPoll);
 	CONNECT(m_nownext_timer->timeout, eServiceMP3::updateEpgCacheNowNext);
-	m_aspect = m_width = m_height = m_framerate = m_progressive = m_gamma = -1;
+	m_aspect = m_width = m_height = m_framerate = m_progressive = -1;
 
 	m_state = stIdle;
 	m_coverart = false;
@@ -1295,7 +1295,6 @@ int eServiceMP3::getInfo(int w)
 	case sVideoWidth: return m_width;
 	case sFrameRate: return m_framerate;
 	case sProgressive: return m_progressive;
-	case sGamma: return m_gamma;
 	case sAspect: return m_aspect;
 	case sTagTitle:
 	case sTagArtist:
@@ -2270,12 +2269,6 @@ void eServiceMP3::gstBusCall(GstMessage *msg)
 							if (strstr(eventname, "Changed"))
 								m_event((iPlayableService*)this, evVideoProgressiveChanged);
 						}
-						else if (!strcmp(eventname, "eventGammaChanged"))
-						{
-							gst_structure_get_int (msgstruct, "gamma", &m_gamma);
-							if (strstr(eventname, "Changed"))
-								m_event((iPlayableService*)this, evVideoGammaChanged);
-						}
 						else if (!strcmp(eventname, "redirect"))
 						{
 							const char *uri = gst_structure_get_string(msgstruct, "new-location");
diff --git a/servicemp3/servicemp3.h b/servicemp3/servicemp3.h
index 15285a1..938c982 100644
--- a/servicemp3/servicemp3.h
+++ b/servicemp3/servicemp3.h
@@ -379,7 +379,7 @@ private:
 
 	RESULT seekToImpl(pts_t to);
 
-	gint m_aspect, m_width, m_height, m_framerate, m_progressive, m_gamma;
+	gint m_aspect, m_width, m_height, m_framerate, m_progressive;
 	std::string m_useragent;
 	std::string m_extra_headers;
 	RESULT trickSeek(gdouble ratio);
-- 
2.19.1
